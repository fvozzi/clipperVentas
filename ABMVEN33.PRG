SET SCOREBOARD ON
SET BELL ON
SET CONFIRM OFF
SET DELETE OFF
SET EXCLUSIVE OFF
RESTORE FROM FISCAL.MEM
DECLARE campos[2]
campos[1]="NUMERO"
campos[2]="NOMBRE"
USE NUMEROS
USE VENDEDOR 
SET INDEX TO VEN_NUM, VEN_NOM
STORE 83 TO JJ
DO WHILE JJ = 83
RESTORE SCREEN FROM PANT1
SET COLOR TO W+/RB
@ 2,6 SAY "           ALTAS Y MODIFICACIONES AL ARHIVO DE VENDEDORES"
@ 23,2 SAY "FINALIZAR: TECLA <=ESC=>"
@ 23,55 SAY "CONSULTA: TECLA <=PgUp=>"
SET COLOR TO W/B
@ 8,14 CLEAR TO 16,67
@ 7,14,16,67 BOX &caja9
@ 8,15 SAY "Numero:"
@ 9,15 SAY "Nombre:"
@ 10,15 SAY "Domicilio:"
@ 11,15 SAY "Localidad:"
@ 12,15 SAY "Tel‚fono:"
@ 13,15 SAY "Tipo Doc.:"
@ 14,15 SAY "Documento:"
@ 15,15 SAY "Comisi¢n:"
STORE 0 TO CLAVE
DO WHILE CLAVE < 1 .OR. CLAVE > 999
STORE SPACE(3) TO BUSCAR
@ 8,23 GET BUSCAR
READ
STORE VAl(BUSCAR) TO CLAVE
IF LASTKEY() = 27
EXIT
ENDIF
IF LASTKEY() = 18
SAVE SCREEN TO MP1
SET ORDER TO 2
GO TOP
KEYBOARD CHR(4)
SET COLOR TO W/R
@ 4,30 CLEAR TO 21,70
@ 4,30,21,71 BOX &caja9
DBEDIT(5,31,20,70,campos,"finc")
RESTORE SCREEN FROM MP1
SET COLOR TO W/B
IF LASTKEY() = 13
STORE NUMERO TO CLAVE
ENDIF
IF LASTKEY() = 27
STORE SPACE(3) TO BUSCAR
STORE 0 TO CLAVE
ENDIF
ENDIF
ENDDO
IF LASTKEY() = 27 
EXIT
ENDIF
SET ORDER TO 1
SEEK CLAVE
IF .NOT. EOF()
@ 8,23 SAY NUMERO
@ 9,30 SAY NOMBRE
@ 10,30 SAY DOMICILIO
@ 11,30 SAY LOCALIDAD
@ 12,30 SAY TELEFONO
@ 13,30 SAY TDOC
@ 14,30 SAY NDOC
@ 15,30 SAY COMISION
ENDIF
IF EOF()
STORE 1 TO VMENU
SET COLOR TO W+/RB
@ 23,2 CLEAR TO 23,78
@ 23,20 PROMPT "CANCELAR"
@ 23,47 PROMPT "AGREGAR CLIENTE"
MENU TO VMENU
DO CASE
  CASE VMENU=1
  LOOP
  CASE VMENU = 2
  SET COLOR TO W/B
  RLOCK()
  APPEND BLANK
  REPLACE NUMERO WITH CLAVE, NOMBRE WITH SPACE(30), DOMICILIO WITH SPACE(30), LOCALIDAD WITH SPACE(30)
  REPLACE TELEFONO WITH SPACE(10), TDOC WITH SPACE(2), NDOC WITH 0, COMISION WITH 0
  @ 9,30 GET NOMBRE
  @ 10,30 GET DOMICILIO
  @ 11,30 GET LOCALIDAD
  @ 12,30 GET TELEFONO
  @ 13,30 GET TDOC
  @ 14,30 GET NDOC
  @ 15,30 GET COMISION
  READ
  UNLOCK
ENDCASE
ENDIF
STORE 1 TO PMENU
SET COLOR TO W+/RB
@ 23,2 CLEAR TO 23,78
@ 23,19 PROMPT "OTRA CONSULTA"
@ 23,50 PROMPT "MODIFICAR DATOS"
MENU TO PMENU
DO CASE
  CASE PMENU = 1
  @ 23,2 CLEAR TO 23,78
  CASE PMENU = 2
  SET COLOR TO W/B
  RLOCK()
  @ 9,30 GET NOMBRE
  @ 10,30 GET DOMICILIO
  @ 11,30 GET LOCALIDAD
  @ 12,30 GET TELEFONO
  @ 13,30 GET TDOC
  @ 14,30 GET NDOC
  @ 15,30 GET COMISION
  READ
  UNLOCK
ENDCASE
ENDDO
CLOSE ALL
RETURN

