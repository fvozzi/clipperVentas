SET SCOREBOARD ON
SET BELL ON
SET CONFIRM OFF
SET DELETE ON
SET DATE BRITISH
SET CENTURY ON
SET EXCLUSIVE OFF
RESTORE FROM FISCAL.MEM
DECLARE campos[2]
SELECT 1
USE VENDEDOR INDEX VEN_NUM, VEN_NOM
campos[1]="NUMERO"
campos[2]="NOMBRE"
SELECT 2
USE COMISION INDEX COM_CLA1
STORE 83 TO JJ
DO WHILE JJ = 83
SET COLOR TO W/N
RESTORE SCREEN FROM PANT1
SET COLOR TO W+/RB
@ 2,6 SAY "               CONSULTA DE MOVIMIENTOS DE VENDEDORES"
SET COLOR TO W/B
@ 8,12 CLEAR TO 12,66
@ 7,14,13,66 BOX &caja9
@ 8,18 SAY "N£mero de Cuenta:"
@ 10,18 SAY "Desde Fecha(dd/mm/aaaa):"
@ 12,18 SAY "Hasta Fecha(dd/mm/aaaa):"
STORE SPACE(4) TO RCLI
STORE CTOD("01/11/1998") TO DESDE
STORE CTOD("31/12/2010") TO HASTA
SAVE SCREEN TO MP1
SELECT 1
SET ORDER TO 2
GO TOP
KEYBOARD CHR(4)
SET COLOR TO W/R
@ 4,30 CLEAR TO 21,70
@ 4,30,21,71 BOX &caja9
DBEDIT(5,31,20,70,campos,"finc")
RESTORE SCREEN FROM MP1
SET COLOR TO W/B
IF LASTKEY() = 13
STORE STR(NUMERO,3) TO RCLI
ENDIF
IF LASTKEY() = 27
STORE SPACE(3) TO RCLI
ENDIF
@ 8,42 SAY RCLI
@ 10,44 GET DESDE
@ 12,44 GET HASTA
READ
SET ORDER TO 1
SEEK VAL(RCLI)
IF EOF()
LOOP
ENDIF
IF .NOT. EOF()
STORE NUMERO TO RCLI
STORE NOMBRE TO RNOMBRE
ENDIF
IF HASTA < DESDE 
LOOP
ENDIF
STORE 1 TO VMENU
SET COLOR TO W+/RB
@ 23,14 PROMPT "CONTINUAR"
@ 23,37 PROMPT "CORREGIR"
@ 23,58 PROMPT "FINALIZAR"
MENU TO VMENU
IF VMENU = 3
STORE 84 TO JJ
EXIT
ENDIF
IF VMENU = 2
LOOP
ENDIF
IF VMENU = 1
RESTORE SCREEN FROM PANTRV
SET COLOR TO W/R
STORE 1 TO HOJA
@ 4,10 SAY "Nombre:    "+NOMBRE
@ 4,59 SAY "Cuenta N§"
@ 4,69 SAY RCLI PICTURE "9999"
@ 5,10 SAY "Domicilio: "+DOMICILIO
@ 5,59 SAY "Pagina N§"
@ 5,69 SAY HOJA PICTURE "9999"
@ 6,10 SAY "Localidad: "+LOCALIDAD
@ 6,53 SAY "Telefono:"
@ 6,63 SAY TELEFONO
STORE 10 TO LIN
SET COLOR TO W/N
SELECT 2
GO TOP
STORE 0 TO SL, FL
STORE STR(RCLI,3) TO BUSCAR 
SEEK BUSCAR
DO WHILE .NOT. EOF() .AND. VENDEDOR = RCLI
IF FECHA > HASTA
EXIT
ENDIF
IF FECHA >= DESDE .AND. FECHA <= HASTA
STORE COMISION TO R_IMP
IF R_IMP <> 0
@ LIN,2 SAY FECHA
@ LIN,13 SAY CBTE
@ LIN,34 SAY FACTURA PICTURE "###,###.##"
IF TMOV = 1
@ LIN,45 SAY R_IMP PICTURE "###,###.##"
SL = SL + R_IMP
ENDIF
IF TMOV = 2
@ LIN,56 SAY R_IMP PICTURE "###,###.##"
SL = SL - R_IMP
ENDIF
@ LIN,67 SAY SL PICTURE "###,###.##"
LIN = LIN + 1
IF LIN = 21
SET COLOR TO W/B
STORE " " TO HH
@ 23,2 SAY "PARA CONTINUAR DIGITE TECLA <=ENTER=> " GET HH
READ
RESTORE SCREEN FROM PANTRV
SET COLOR TO W/R
HOJA = HOJA + 1
SELECT 1
@ 4,10 SAY "Nombre:    "+NOMBRE
@ 4,59 SAY "Cuenta N§"
@ 4,69 SAY RCLI PICTURE "9999"
@ 5,10 SAY "Domicilio: "+DOMICILIO
@ 5,59 SAY "Pagina N§"
@ 5,69 SAY HOJA PICTURE "9999"
@ 6,10 SAY "Localidad: "+LOCALIDAD
@ 6,53 SAY "Telefono:"
@ 6,63 SAY TELEFONO
STORE 10 TO LIN
SET COLOR TO W/N
SELECT 2
ENDIF
ENDIF
ENDIF
SKIP
ENDDO
SET COLOR TO W/B
STORE 1 TO PMENU
@ 23,13 PROMPT "OTRA CONSULTA"
@ 23,38 PROMPT "IMPRIMIR"
@ 23,58 PROMPT "FINALIZAR"
MENU TO PMENU
IF PMENU = 3
STORE 84 TO JJ
EXIT
ENDIF
IF PMENU = 2
SELECT 1
SET DEVICE TO PRINTER
@ 1,1 SAY CHR(27)+CHR(67)+CHR(72)
@ 2,1 SAY CHR(15)
@ 2,16 SAY CHR(14)+"CASA HIDALGO S.A." 
@ 3,1 SAY "Avda. 59 N§ 2857 - Tel. Fax (0262) 22211 - 7630 Necochea(Bs.As.)"
@ 4,1 SAY CHR(18)
@ 5,22 SAY CHR(14)+"COMISIONES VENDEDORES"
STORE 1 TO HOJA
@ 7,1 SAY "Nombre:    "+NOMBRE
@ 7,67 SAY "Cuenta N§"
@ 7,77 SAY RCLI PICTURE "9999"
@ 8,1 SAY "Domicilio: "+DOMICILIO
@ 8,67 SAY "Pagina N§"
@ 8,77 SAY HOJA PICTURE "9999"
@ 9,1 SAY "Localidad: "+LOCALIDAD
@ 9,61 SAY "Telefono:"
@ 9,71 SAY TELEFONO
@ 10,1 SAY REPLICATE("-",80)
@ 11,2 SAY "FECHA"
@ 11,16 SAY "REFERENCIA"
@ 11,35 SAY "IMPORTE"
@ 11,47 SAY "DEBITOS"
@ 11,58 SAY "CREDITOS"
@ 11,71 SAY "SALDO"
@ 12,1 SAY REPLICATE("-",80)
STORE 13 TO LIN
SELECT 2
GO TOP
STORE 0 TO SL, FL
STORE STR(RCLI,3) TO BUSCAR 
SEEK BUSCAR
DO WHILE .NOT. EOF() .AND. VENDEDOR = RCLI
IF FECHA > HASTA
EXIT
ENDIF
IF FECHA >= DESDE .AND. FECHA <= HASTA
STORE COMISION TO R_IMP
IF R_IMP <> 0
@ LIN,1 SAY FECHA
@ LIN,11 SAY CBTE
@ LIN,33 SAY FACTURA
IF TMOV = 1
@ LIN,45 SAY R_IMP PICTURE "###,###.##"
SL = SL + R_IMP
ENDIF
IF TMOV = 2
@ LIN,57 SAY R_IMP PICTURE "###,###.##"
SL = SL - R_IMP
ENDIF
@ LIN,69 SAY SL PICTURE "###,###.##"
LIN = LIN + 1
IF LIN = 68
SELECT 1
@ 2,16 SAY CHR(15)+CHR(14)+"CASA HIDALGO S.A." 
@ 3,1 SAY "Avda. 59 N§ 2857 - Tel. Fax (0262) 22211 - 7630 Necochea(Bs.As.)"
@ 4,1 SAY CHR(18)
@ 5,22 SAY CHR(14)+"COMISIONES VENDEDORES"
HOJA = HOJA + 1
@ 7,1 SAY "Nombre:    "+NOMBRE
@ 7,67 SAY "Cuenta N§"
@ 7,77 SAY RCLI PICTURE "9999"
@ 8,1 SAY "Domicilio: "+DOMICILIO
@ 8,67 SAY "Pagina N§"
@ 8,77 SAY HOJA PICTURE "9999"
@ 9,1 SAY "Localidad: "+LOCALIDAD
@ 9,61 SAY "Telefono:"
@ 9,71 SAY TELEFONO
@ 10,1 SAY REPLICATE("-",80)
@ 11,2 SAY "FECHA"
@ 11,16 SAY "REFERENCIA"
@ 11,35 SAY "IMPORTE"
@ 11,47 SAY "DEBITOS"
@ 11,58 SAY "CREDITOS"
@ 11,71 SAY "SALDO"
@ 12,1 SAY REPLICATE("-",80)
STORE 13 TO LIN
SELECT 2
ENDIF
ENDIF
ENDIF
SKIP
ENDDO
EJECT
SET DEVICE TO SCREEN
ENDIF
ENDIF
ENDDO
CLOSE ALL
RETURN
